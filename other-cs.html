<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ec1027-guide - 5&nbsp; Forma funcional y problemas con los datos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ts-part.html" rel="next">
<link href="./lpm.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./cs-part.html">Regresión con datos de corte transversal</a></li><li class="breadcrumb-item"><a href="./other-cs.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Forma funcional y problemas con los datos</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ec1027-guide</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./cs-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regresión con datos de corte transversal</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mcrl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">El modelo clásico de regresión lineal</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asymp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Propiedades asintóticas del estimador MCO</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./het.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Heteroscedasticidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lpm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">El modelo de probabilidad lineal</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-cs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Forma funcional y problemas con los datos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ts-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regresión con datos de series temporales</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introducción a las series temporales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ols-ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">El estimador MCO con series temporales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regr-ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regresión con series temporales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autocorr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Autocorrelación</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#forma-funcional" id="toc-forma-funcional" class="nav-link active" data-scroll-target="#forma-funcional"><span class="header-section-number">5.1</span> Forma funcional</a>
  <ul class="collapse">
  <li><a href="#forma-funcional-1" id="toc-forma-funcional-1" class="nav-link" data-scroll-target="#forma-funcional-1">Forma funcional</a></li>
  <li><a href="#consecuencias" id="toc-consecuencias" class="nav-link" data-scroll-target="#consecuencias">Consecuencias</a></li>
  <li><a href="#detección" id="toc-detección" class="nav-link" data-scroll-target="#detección">Detección</a></li>
  <li><a href="#bondad-del-ajuste" id="toc-bondad-del-ajuste" class="nav-link" data-scroll-target="#bondad-del-ajuste">Bondad del ajuste</a></li>
  <li><a href="#contrastes-f" id="toc-contrastes-f" class="nav-link" data-scroll-target="#contrastes-f">Contrastes <span class="math inline">F</span></a></li>
  <li><a href="#comment-contraste-reset" id="toc-comment-contraste-reset" class="nav-link" data-scroll-target="#comment-contraste-reset">COMMENT Contraste RESET</a></li>
  <li><a href="#comment-cálculo-del-contraste-reset" id="toc-comment-cálculo-del-contraste-reset" class="nav-link" data-scroll-target="#comment-cálculo-del-contraste-reset">COMMENT Cálculo del contraste RESET</a></li>
  <li><a href="#comment-variaciones-del-contraste-reset" id="toc-comment-variaciones-del-contraste-reset" class="nav-link" data-scroll-target="#comment-variaciones-del-contraste-reset">COMMENT Variaciones del contraste RESET</a></li>
  <li><a href="#modelos-no-anidados" id="toc-modelos-no-anidados" class="nav-link" data-scroll-target="#modelos-no-anidados">Modelos no anidados</a></li>
  <li><a href="#contrastes-de-abarcamiento" id="toc-contrastes-de-abarcamiento" class="nav-link" data-scroll-target="#contrastes-de-abarcamiento">Contrastes de abarcamiento</a></li>
  <li><a href="#contrastes-de-abarcamiento-ejemplo" id="toc-contrastes-de-abarcamiento-ejemplo" class="nav-link" data-scroll-target="#contrastes-de-abarcamiento-ejemplo">Contrastes de abarcamiento: ejemplo</a></li>
  <li><a href="#contrastes-de-davidson-mackinnon" id="toc-contrastes-de-davidson-mackinnon" class="nav-link" data-scroll-target="#contrastes-de-davidson-mackinnon">Contrastes de Davidson-MacKinnon</a></li>
  <li><a href="#contrastes-de-davidson-mackinnon-ejemplo" id="toc-contrastes-de-davidson-mackinnon-ejemplo" class="nav-link" data-scroll-target="#contrastes-de-davidson-mackinnon-ejemplo">Contrastes de Davidson-MacKinnon: ejemplo</a></li>
  <li><a href="#contrastes-de-hipótesis-no-anidadas-y-heteroscedasticidad" id="toc-contrastes-de-hipótesis-no-anidadas-y-heteroscedasticidad" class="nav-link" data-scroll-target="#contrastes-de-hipótesis-no-anidadas-y-heteroscedasticidad">Contrastes de hipótesis no anidadas y heteroscedasticidad</a></li>
  <li><a href="#contrastes-de-hipótesis-no-anidadas-limitaciones" id="toc-contrastes-de-hipótesis-no-anidadas-limitaciones" class="nav-link" data-scroll-target="#contrastes-de-hipótesis-no-anidadas-limitaciones">Contrastes de hipótesis no anidadas: limitaciones</a></li>
  </ul></li>
  <li><a href="#observaciones-incompletas" id="toc-observaciones-incompletas" class="nav-link" data-scroll-target="#observaciones-incompletas"><span class="header-section-number">5.2</span> Observaciones incompletas</a>
  <ul class="collapse">
  <li><a href="#observaciones-incompletas-1" id="toc-observaciones-incompletas-1" class="nav-link" data-scroll-target="#observaciones-incompletas-1">Observaciones incompletas</a></li>
  <li><a href="#observaciones-incompletas-consecuencias" id="toc-observaciones-incompletas-consecuencias" class="nav-link" data-scroll-target="#observaciones-incompletas-consecuencias">Observaciones incompletas: consecuencias</a></li>
  </ul></li>
  <li><a href="#muestreo-no-aleatorio" id="toc-muestreo-no-aleatorio" class="nav-link" data-scroll-target="#muestreo-no-aleatorio"><span class="header-section-number">5.3</span> Muestreo no aleatorio</a>
  <ul class="collapse">
  <li><a href="#muestreo-no-aleatorio-1" id="toc-muestreo-no-aleatorio-1" class="nav-link" data-scroll-target="#muestreo-no-aleatorio-1">Muestreo no aleatorio</a></li>
  <li><a href="#selección-muestral" id="toc-selección-muestral" class="nav-link" data-scroll-target="#selección-muestral">Selección muestral</a></li>
  <li><a href="#selección-muestral-consecuencias" id="toc-selección-muestral-consecuencias" class="nav-link" data-scroll-target="#selección-muestral-consecuencias">Selección muestral: consecuencias</a></li>
  <li><a href="#muestreo-estratificado" id="toc-muestreo-estratificado" class="nav-link" data-scroll-target="#muestreo-estratificado">Muestreo estratificado</a></li>
  <li><a href="#muestreo-estratificado-consecuencias" id="toc-muestreo-estratificado-consecuencias" class="nav-link" data-scroll-target="#muestreo-estratificado-consecuencias">Muestreo estratificado: consecuencias</a></li>
  </ul></li>
  <li><a href="#observaciones-atípicas-y-observaciones-influyentes" id="toc-observaciones-atípicas-y-observaciones-influyentes" class="nav-link" data-scroll-target="#observaciones-atípicas-y-observaciones-influyentes"><span class="header-section-number">5.4</span> Observaciones atípicas y observaciones influyentes</a>
  <ul class="collapse">
  <li><a href="#observaciones-atípicas-y-observaciones-influyentes-1" id="toc-observaciones-atípicas-y-observaciones-influyentes-1" class="nav-link" data-scroll-target="#observaciones-atípicas-y-observaciones-influyentes-1">Observaciones atípicas y observaciones influyentes</a></li>
  <li><a href="#observaciones-atípicas" id="toc-observaciones-atípicas" class="nav-link" data-scroll-target="#observaciones-atípicas">Observaciones atípicas</a></li>
  <li><a href="#análisis-de-los-residuos" id="toc-análisis-de-los-residuos" class="nav-link" data-scroll-target="#análisis-de-los-residuos">Análisis de los residuos</a></li>
  <li><a href="#residuos-estudentizados" id="toc-residuos-estudentizados" class="nav-link" data-scroll-target="#residuos-estudentizados">Residuos estudentizados</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Forma funcional y problemas con los datos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="forma-funcional" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="forma-funcional"><span class="header-section-number">5.1</span> Forma funcional</h2>
<section id="forma-funcional-1" class="level3">
<h3 class="anchored" data-anchor-id="forma-funcional-1">Forma funcional</h3>
<p>Por ejemplo, supongamos que la siguiente ecuación de salarios satisface los supuestos <strong>RLM.1</strong> a <strong>RLM.4</strong>: <span class="math display">
  \begin{aligned}
  \log(\mathit{wage}) = &amp;\beta_{0}
  + \beta_{1} \mathit{educ}
  + \beta_{2} \mathit{exper}
  + \beta_{3} \mathit{exper}^{2} \\
  &amp;+ \beta_{4} \mathit{female}
  + \beta_{5} \mathit{female} \cdot \mathit{educ}
  + u
  \end{aligned}
</span> ¿Qué consecuencias tendría estimar el modelo sin <span class="math inline">\mathit{exper}^2</span> o sin el término de interacción <span class="math inline">\mathit{female} \cdot \mathit{educ}</span>? ¿Cómo podemos detectar errores de especificación de la <strong>forma funcional</strong>?</p>
</section>
<section id="consecuencias" class="level3">
<h3 class="anchored" data-anchor-id="consecuencias">Consecuencias</h3>
<ul>
<li><p>Al omitir términos relevantes, es probable que obtengamos <strong>estimaciones sesgadas</strong> de los restantes parámetros.</p></li>
<li><p>No está claro como interpretar los <strong>efectos marginales</strong> de las explicativas.</p></li>
</ul>
</section>
<section id="detección" class="level3">
<h3 class="anchored" data-anchor-id="detección">Detección</h3>
<ul>
<li><p>Se han propuesto muchas alternativas para detectar errores de especificación de la forma funcional. En este curso consideraremos:</p>
<ul>
<li><p>Medidas de bondad del ajuste.</p></li>
<li><p>Contrastes <span class="math inline">F</span>.</p></li>
<li><p>Contrastes de <strong>hipótesis no anidadas</strong>.</p></li>
</ul></li>
<li><p>Todos estos contrastes suponen que la especificación de la variable dependiente es correcta. No sirven, por ejemplo, para elegir entre tomar logaritmos de la variable dependiente o no.</p></li>
</ul>
</section>
<section id="bondad-del-ajuste" class="level3">
<h3 class="anchored" data-anchor-id="bondad-del-ajuste">Bondad del ajuste</h3>
<ul>
<li><p>Una forma simple de comparar modelos alternativos es usar medidas de bondad del ajuste.</p></li>
<li><p>Debe usarse el <span class="math inline">R^2</span> ajustado cuando los modelos tienen un número diferente de variables explicativas.</p></li>
</ul>
</section>
<section id="contrastes-f" class="level3">
<h3 class="anchored" data-anchor-id="contrastes-f">Contrastes <span class="math inline">F</span></h3>
<ul>
<li><p>Podemos probar diferentes especificaciones alternativas incluyendo potencias, términos de interacción y otras transformaciones de las explicativas.</p></li>
<li><p>Los contrastes <span class="math inline">F</span> se pueden utilizar para determinar la significación de los términos que se añaden al modelo original.</p></li>
</ul>
</section>
<section id="comment-contraste-reset" class="level3">
<h3 class="anchored" data-anchor-id="comment-contraste-reset">COMMENT Contraste RESET</h3>
<ul>
<li><p>El contraste RESET se diseñó para detectar problemas de mala especificación de la forma funcional.</p></li>
<li><p>Bajo la hipótesis nula, la forma funcional es correcta. No es necesario especificar la forma funcional bajo la hipótesis alternativa.</p></li>
</ul>
</section>
<section id="comment-cálculo-del-contraste-reset" class="level3">
<h3 class="anchored" data-anchor-id="comment-cálculo-del-contraste-reset">COMMENT Cálculo del contraste RESET</h3>
<ul>
<li><p>Se estima por MCO el modelo original: <span class="math display">
  y = \beta_{0} + \beta_{1} x_{1} + \dots + \beta_{k} x_{k} + u
</span></p></li>
<li><p>Se obtienen las predicciones de la variable dependiente, <span class="math inline">\hat{y}</span>, y se añaden al modelo potencias de <span class="math inline">\hat{y}</span>: <span class="math display">
  y = \beta_{0} + \beta_{1} x_{1} + \dots + \beta_{k} x_{k}
  + \delta_1 \hat{y}^2 + \delta_2 \hat{y}^3 +  u
</span></p></li>
<li><p>Bajo la hipótesis nula, el modelo original estaba bien especificado y los términos adicionales no son significativos: <span class="math inline">H_0\!: \delta_1 = \delta_2 = 0</span>. Para verificar esta condición se usa un contraste <span class="math inline">F</span>.</p></li>
</ul>
</section>
<section id="comment-variaciones-del-contraste-reset" class="level3">
<h3 class="anchored" data-anchor-id="comment-variaciones-del-contraste-reset">COMMENT Variaciones del contraste RESET</h3>
<ul>
<li><p>Algunos autores recomiendan añadir solamente los cuadrados de las predicciones: <span class="math display">
  y = \beta_{0} + \beta_{1} x_{1} + \dots + \beta_{k} x_{k}
  + \delta_1 \hat{y}^2  +  u
</span> En este caso podemos usar un contraste <span class="math inline">t</span> para la <span class="math inline">H_0\!: \delta_1 = 0</span>.</p></li>
<li><p>Si la varianza condicional de término de error no fuera constante, se utilizarían contrates <span class="math inline">F</span> y <span class="math inline">t</span> robustos a heteroscedasticidad.</p></li>
</ul>
</section>
<section id="modelos-no-anidados" class="level3">
<h3 class="anchored" data-anchor-id="modelos-no-anidados">Modelos no anidados</h3>
<ul>
<li><p>¿Cómo podemos elegir entre los siguientes modelos? <span class="math display">
\begin{gather}
  y = \alpha_{0}
  + \alpha_{1} x_{1}
  + \alpha_{2} x_{2}
  + u \tag{Modelo A} \\
  y = \beta_{0}
  + \beta_{1} \log(x_{1})
  + \beta_{2} \log(x_{2})
  + v \tag{Modelo B}
\end{gather}
</span></p></li>
<li><p>El ejemplo anterior es un caso de <strong>modelos no anidados</strong>: ninguno de los dos modelos es un caso especial del otro.</p></li>
<li><p>No podemos usar contrastes <span class="math inline">F</span> para comparar modelos no anidados.</p></li>
</ul>
</section>
<section id="contrastes-de-abarcamiento" class="level3">
<h3 class="anchored" data-anchor-id="contrastes-de-abarcamiento">Contrastes de abarcamiento</h3>
<ul>
<li>Los <strong>contrastes de abarcamiento</strong> (<em>encompassing tests</em>) se basan en la construcción de un tercer modelo que contenga como casos especiales los modelos que se quieren comparar.</li>
</ul>
</section>
<section id="contrastes-de-abarcamiento-ejemplo" class="level3">
<h3 class="anchored" data-anchor-id="contrastes-de-abarcamiento-ejemplo">Contrastes de abarcamiento: ejemplo</h3>
<ul>
<li><p>El siguiente modelo tiene como casos especiales el Modelo A y el Modelo B de nuestro ejemplo: <span class="math display">
  y = \gamma_{0}
  + \gamma_{1} x_{1}
  + \gamma_{2} x_{2}
  + \gamma_{3} \log(x_{1})
  + \gamma_{4} \log(x_{2})
  + \text{error}
</span></p></li>
<li><p>Para contrastar la validez de un modelo frente a otro podemos usar los contrastes <span class="math inline">F</span> correspondientes a las siguientes hipótesis:</p>
<table class="table">
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Modelo A</strong> frente a Modelo B:</td>
<td><span class="math inline">H_0\!: \gamma_3 = \gamma_4 = 0</span></td>
</tr>
<tr class="even">
<td><strong>Modelo B</strong> frente a Modelo A:</td>
<td><span class="math inline">H_0\!: \gamma_1 = \gamma_2 = 0</span></td>
</tr>
</tbody>
</table></li>
</ul>
</section>
<section id="contrastes-de-davidson-mackinnon" class="level3">
<h3 class="anchored" data-anchor-id="contrastes-de-davidson-mackinnon">Contrastes de Davidson-MacKinnon</h3>
<p>Davidson y MacKinnon proponen añadir a un modelo las predicciones obtenidas con otro modelo y contrastar si ese término adicional tiene capacidad explicativa.</p>
</section>
<section id="contrastes-de-davidson-mackinnon-ejemplo" class="level3">
<h3 class="anchored" data-anchor-id="contrastes-de-davidson-mackinnon-ejemplo">Contrastes de Davidson-MacKinnon: ejemplo</h3>
<ul>
<li>Para contrastar la validez del Modelo A:
<ul>
<li>Se estima el Modelo B y se obtienen las predicciones: <span class="math inline">\hat{y}_B</span>.</li>
<li>Se contrasta <span class="math inline">H_0\!: \theta_B = 0</span> en la regresión: <span class="math display">
  y = \alpha_{0}
  + \alpha_{1} x_{1}
  + \alpha_{2} x_{2}
  + \theta_{B} \hat{y}_{B}
  + \text{error}
</span></li>
</ul></li>
<li>En el caso del Modelo B, se contrasta <span class="math inline">H_0\!: \theta_A = 0</span> en la regresión: <span class="math display">
    y = \beta_{0}
    + \beta_{1} \log(x_{1})
    + \beta_{2} \log(x_{2})
    + \theta_{A} \hat{y}_{A}
    + \text{error}
  </span> donde <span class="math inline">\hat{y}_A</span> son las predicciones obtenidas con el Modelo A.</li>
</ul>
</section>
<section id="contrastes-de-hipótesis-no-anidadas-y-heteroscedasticidad" class="level3">
<h3 class="anchored" data-anchor-id="contrastes-de-hipótesis-no-anidadas-y-heteroscedasticidad">Contrastes de hipótesis no anidadas y heteroscedasticidad</h3>
<ul>
<li><p>Las hipótesis no anidadas se contrastan con estadísticos <span class="math inline">t</span> o <span class="math inline">F</span> en modelos de regresión que se construyen con el único objetivo del contraste de esas hipótesis.</p></li>
<li><p>En caso de heteroscedasticidad se utilizarían las versiones robustas de los contrastes <span class="math inline">t</span> y <span class="math inline">F</span>.</p></li>
</ul>
</section>
<section id="contrastes-de-hipótesis-no-anidadas-limitaciones" class="level3">
<h3 class="anchored" data-anchor-id="contrastes-de-hipótesis-no-anidadas-limitaciones">Contrastes de hipótesis no anidadas: limitaciones</h3>
<ul>
<li><p>Estos contrastes no producen siempre una respuesta clara: es posible que se acepten los dos modelos o que se rechacen ambos.</p></li>
<li><p>Rechazar un modelo no quiere decir que el modelo rival sea el correcto.</p></li>
</ul>
</section>
</section>
<section id="observaciones-incompletas" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="observaciones-incompletas"><span class="header-section-number">5.2</span> Observaciones incompletas</h2>
<section id="observaciones-incompletas-1" class="level3">
<h3 class="anchored" data-anchor-id="observaciones-incompletas-1">Observaciones incompletas</h3>
<ul>
<li><p>Un problema relativamente frecuente es la presencia de <strong>observaciones incompletas</strong> para las que faltan los valores de algunas variables.</p></li>
<li><p>Usualmente se ignoran las observaciones incompletas en la estimación.</p></li>
</ul>
</section>
<section id="observaciones-incompletas-consecuencias" class="level3">
<h3 class="anchored" data-anchor-id="observaciones-incompletas-consecuencias">Observaciones incompletas: consecuencias</h3>
<ul>
<li><p>Si se eliminan las observaciones incompletas para la estimación, se reduce el número de observaciones y la precisión de los estimadores empeora.</p></li>
<li><p>Las estimaciones pueden estar sesgadas si la falta de información responde a razones sistemáticas (por ejemplo: las familias más ricas no revelan su renta con mayor frecuencia que familias más pobres).</p></li>
<li><p>No se introducen sesgo si las observaciones incompletas se producen por puro azar.</p></li>
</ul>
</section>
</section>
<section id="muestreo-no-aleatorio" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="muestreo-no-aleatorio"><span class="header-section-number">5.3</span> Muestreo no aleatorio</h2>
<section id="muestreo-no-aleatorio-1" class="level3">
<h3 class="anchored" data-anchor-id="muestreo-no-aleatorio-1">Muestreo no aleatorio</h3>
<p>El <strong>muestreo no aleatorio</strong> se puede deber a diversas razones:</p>
<ul>
<li><p>Observaciones incompletas.</p></li>
<li><p>Esquemas de obtención de los datos.</p></li>
</ul>
</section>
<section id="selección-muestral" class="level3">
<h3 class="anchored" data-anchor-id="selección-muestral">Selección muestral</h3>
<p><strong>Selección muestral</strong>: El mecanismo que determina qué observaciones forman parte de la muestra no es aleatorio. Distinguimos entre:</p>
<ul>
<li><p><strong>Selección muestral exógena</strong>: la selección de la muestra se basa en los valores que toman las variables explicativas.</p></li>
<li><p><strong>Selección muestral endógena</strong>: la muestra no contiene observaciones para algunos valores de la variable dependiente.</p></li>
</ul>
</section>
<section id="selección-muestral-consecuencias" class="level3">
<h3 class="anchored" data-anchor-id="selección-muestral-consecuencias">Selección muestral: consecuencias</h3>
<ul>
<li><p><strong>Selección muestral exógena</strong>: Los estimadores siguen siendo insesgados y consistentes mientras se cumpla el supuesto de media condicional nula del término de error.</p></li>
<li><p><strong>Selección muestral endógena</strong>: La selección en base a la variable dependiente implica que el supuesto <strong>RLM.4</strong> no se cumple, por lo que MCO sería en este caso sesgado e inconsistente.</p></li>
</ul>
</section>
<section id="muestreo-estratificado" class="level3">
<h3 class="anchored" data-anchor-id="muestreo-estratificado">Muestreo estratificado</h3>
<ul>
<li><p><strong>Estratos</strong>: subgrupos de una población que no se solapan y cuya unión es la población total.</p></li>
<li><p><strong>Muestreo estratificado</strong>: la frecuencia con que se muestrean los diferentes estratos no es proporcional a su tamaño.</p></li>
<li><p>Se trata de garantizar que en la muestra final estén suficientemente representados grupos minoritarios.</p></li>
</ul>
</section>
<section id="muestreo-estratificado-consecuencias" class="level3">
<h3 class="anchored" data-anchor-id="muestreo-estratificado-consecuencias">Muestreo estratificado: consecuencias</h3>
<ul>
<li><p>Si la estratificación se basa en una o más variables explicativas, el estimador de MCO será insesgado y consistente.</p></li>
<li><p>Por el contrario si la estratificación se realiza en base a los valores que toma la variable dependiente, MCO será sesgado e inconsistente.</p></li>
</ul>
</section>
</section>
<section id="observaciones-atípicas-y-observaciones-influyentes" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="observaciones-atípicas-y-observaciones-influyentes"><span class="header-section-number">5.4</span> Observaciones atípicas y observaciones influyentes</h2>
<section id="observaciones-atípicas-y-observaciones-influyentes-1" class="level3">
<h3 class="anchored" data-anchor-id="observaciones-atípicas-y-observaciones-influyentes-1">Observaciones atípicas y observaciones influyentes</h3>
<ul>
<li><p><strong>Observaciones atípicas</strong> (<em>outliers</em>): observaciones para las que una variable toma un valor inusualmente grande.</p></li>
<li><p><strong>Observaciones influyentes</strong>: son aquellas que si se eliminan de la muestra provocan grandes cambios en las estimaciones de MCO.</p></li>
</ul>
</section>
<section id="observaciones-atípicas" class="level3">
<h3 class="anchored" data-anchor-id="observaciones-atípicas">Observaciones atípicas</h3>
<ul>
<li><p>Pueden deberse a errores en la introducción de los datos. Si la corrección del error no es obvia, se deberían eliminar esas observaciones.</p></li>
<li><p>Otra posible razón es la inclusión en la muestra de observaciones con características muy diferentes al resto de la población. Con frecuencia, la mejor estrategia en estos casos es presentar los resultados con y sin las observaciones atípicas.</p></li>
</ul>
</section>
<section id="análisis-de-los-residuos" class="level3">
<h3 class="anchored" data-anchor-id="análisis-de-los-residuos">Análisis de los residuos</h3>
<ul>
<li>El tamaño de los residuos de MCO no es un buen indicador para detectar observaciones atípicas. En general, los residuos de estas observaciones no son especialmente grandes.</li>
</ul>
</section>
<section id="residuos-estudentizados" class="level3">
<h3 class="anchored" data-anchor-id="residuos-estudentizados">Residuos estudentizados</h3>
<ul>
<li><p>En la detección de observaciones atípicas se suelen emplear los <strong>residuos estudentizados</strong>, <span class="math inline">\hat{\epsilon}</span>.</p></li>
<li><p>El residuo estudentizado para la observación <span class="math inline">i</span>, <span class="math inline">\hat{\epsilon}_i</span>, puede obtenerse añadiendo al modelo una ficticia que sólo toma el valor 1 en esa observación: <span class="math inline">\hat{\epsilon}_i</span> es el estadístico <span class="math inline">t</span> de esa ficticia.</p></li>
<li><p>Se considerarían atípicas aquellas observaciones cuyos residuos estudentizados sean muy grandes de acuerdo con la distribución <span class="math inline">t_{n-k-2}</span>.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lpm.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">El modelo de probabilidad lineal</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ts-part.html" class="pagination-link">
        <span class="nav-page-text">Regresión con datos de series temporales</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>